# Agent 系统配置文件
# 支持环境变量替换: ${VAR} 或 ${VAR:default}

version: "1.0"

# ==================== LLM 配置 ====================
llm:
  # 默认 LLM 配置（用于未指定 llm 的子代理）
  default:
    model: ${MODEL:deepseek-chat}
    base_url: ${BASE_URL:https://api.deepseek.com}
    api_key: ${API_KEY}
    temperature: 0.7
    max_tokens: 4096

  # 命名 LLM 配置（供子代理引用）
  profiles:
    fast:
      model: ${MODEL:deepseek-chat}
      temperature: 0.5
      max_tokens: 2048

    powerful:
      model: ${MODEL:deepseek-chat}
      temperature: 0.8
      max_tokens: 8192

# ==================== 工具配置 ====================
tools:
  # 内置工具开关
  builtin:
    sql_tools: true
    python_tools: true
    ml_tools: true
    graph_tools: false  # 禁用图分析工具（使用 execute_python_safe + networkx 替代）
    dagster_tools: false  # 暂时禁用，后续重新设计

  # 工具别名（可选）
  aliases:
    db_query: execute_sql
    run_python: execute_python_safe

# ==================== 子代理配置 ====================
# 所有 agent 共同规范：
# - 工作前先 ls /imports/ 和 /exports/ 查看可用文件
# - 使用内置 read_file 读取文件，write_file 写入 /exports/
# - 不写入 /imports/（只读目录）
# - exports 命名规范：{来源}_{处理类型}_{描述}.{ext}

subagents:
  # 数据采集子代理
  data-collector:
    description: |
      数据采集代理。从数据库或 /imports/ 获取数据，导出到 /exports/。
      工作前先 ls /imports/ 和 /exports/ 查看文件。
      使用内置 read_file/write_file 操作文件。
      可使用 Python 读取 Excel/CSV 等二进制文件。
    llm: fast
    tools:
      - list_tables
      - describe_table
      - execute_sql
      - execute_python_safe
    prompt_file: prompts/data_collector.md

  # 数据分析子代理
  data-analyzer:
    description: |
      数据分析代理。从 /imports/ 或 /exports/ 读取数据进行分析。
      工作前先 ls /imports/ 和 /exports/ 查看文件。
      分析结果保存到 /exports/。
    llm: powerful
    tools:
      - execute_python_safe
      - train_model
      - predict
    prompt_file: prompts/data_analyzer.md

  # 报告生成子代理
  report-writer:
    description: |
      报告生成代理。从 /imports/ 或 /exports/ 读取数据生成图表和报告。
      工作前先 ls /imports/ 和 /exports/ 查看文件。
      图表和报告保存到 /exports/。
    llm: default
    tools:
      - execute_python_safe
    prompt_file: prompts/report_writer.md


# ==================== 协调者配置 ====================
coordinator:
  llm: default
  prompt_file: prompts/coordinator.md
  use_default_prompt: true

# ==================== 热重载配置 ====================
hot_reload:
  enabled: false
  watch_paths:
    - config/agents.yaml
    - config/prompts/
  debounce_ms: 1000
